{
  "$schema": "https://railway.app/railway.schema.json",
  "name": "Mautic 5",
  "description": "Mautic 5 Marketing Automation Platform with all services (web, worker, cron) and MySQL database",
  "services": [
    {
      "name": "Mautic Web",
      "type": "dockerfile",
      "dockerfilePath": "Dockerfile",
      "env": {
        "DOCKER_MAUTIC_ROLE": "mautic_web",
        "MYSQL_HOST": "{{.MYSQL_HOST}}",
        "MYSQL_PORT": "3306",
        "MYSQL_DATABASE": "mautic",
        "MYSQL_USER": "{{.MYSQL_USER}}",
        "MYSQL_PASSWORD": "{{.MYSQL_PASSWORD}}",
        "PHP_INI_VALUE_DATE_TIMEZONE": "UTC",
        "PHP_INI_VALUE_MEMORY_LIMIT": "512M",
        "PHP_INI_VALUE_UPLOAD_MAX_FILESIZE": "512M",
        "PHP_INI_VALUE_POST_MAX_FILESIZE": "512M",
        "PHP_INI_VALUE_MAX_EXECUTION_TIME": "300"
      }
    },
    {
      "name": "Mautic Worker",
      "type": "dockerfile",
      "dockerfilePath": "Dockerfile",
      "env": {
        "DOCKER_MAUTIC_ROLE": "mautic_worker",
        "MYSQL_HOST": "{{.MYSQL_HOST}}",
        "MYSQL_PORT": "3306",
        "MYSQL_DATABASE": "mautic",
        "MYSQL_USER": "{{.MYSQL_USER}}",
        "MYSQL_PASSWORD": "{{.MYSQL_PASSWORD}}",
        "DOCKER_MAUTIC_WORKERS_CONSUME_EMAIL": "2",
        "DOCKER_MAUTIC_WORKERS_CONSUME_HIT": "2",
        "DOCKER_MAUTIC_WORKERS_CONSUME_FAILED": "2"
      }
    },
    {
      "name": "Mautic Cron",
      "type": "dockerfile",
      "dockerfilePath": "Dockerfile",
      "env": {
        "DOCKER_MAUTIC_ROLE": "mautic_cron",
        "MYSQL_HOST": "{{.MYSQL_HOST}}",
        "MYSQL_PORT": "3306",
        "MYSQL_DATABASE": "mautic",
        "MYSQL_USER": "{{.MYSQL_USER}}",
        "MYSQL_PASSWORD": "{{.MYSQL_PASSWORD}}"
      }
    },
    {
      "name": "MySQL Database",
      "type": "mysql",
      "version": "8.0",
      "env": {
        "MYSQL_DATABASE": "mautic",
        "MYSQL_USER": "{{.MYSQL_USER}}",
        "MYSQL_PASSWORD": "{{.MYSQL_PASSWORD}}",
        "MYSQL_ROOT_PASSWORD": "{{.MYSQL_ROOT_PASSWORD}}"
      }
    }
  ],
  "variables": {
    "MYSQL_USER": {
      "type": "string",
      "description": "MySQL user for Mautic database",
      "default": "mautic"
    },
    "MYSQL_PASSWORD": {
      "type": "string",
      "description": "MySQL password for Mautic database",
      "secret": true
    },
    "MYSQL_ROOT_PASSWORD": {
      "type": "string",
      "description": "MySQL root password",
      "secret": true
    }
  }
} 